A pan-cancer AI framework for non-invasive genomic profiling

Liyuan Wu1*, Hubin Yin2*, Rui Chen3*, Sujun Han1*, Shunan Che1, Zixian Wang4, Hong Weng5, Dong Chen1, Wenkuan Wang1, Youyan Guan1, Xingkai Li1, Xuhang Wang6, Ying Ma6, Baoyi Han6, Fangming Wang7, Lan Wang8, Duocai Li9, Qinxin Zhao10, Peipei Meng10, Shancheng Ren9#, Fei Liu1#, for the VTP consortium†.

1 National Cancer Center/National Clinical Research Center for Cancer/Cancer Hospital, Chinese Academy of Medical Sciences and Peking Union Medical College, Beijing, China
2 The First Affiliated Hospital of Chongqing Medical University, Chongqing, China
3 Shanghai Jiao Tong University School of Medicine Renji Hospital, Shanghai, China
4 Department of Medical Oncology, Sun Yat-sen University Cancer Center, State Key Laboratory of Oncology in South China, Guangdong Provincial Clinical Research Center for Cancer, Guangzhou, China
5 Zhongnan Hospital of Wuhan University, Wuhan, China
6 The First Affiliated Hospital of Dalian Medical University, Dalian, China
7 Beijing Tsinghua Changgung Hospital, Beijing, China
8 National Clinical Research Center for Ocular Diseases, Eye Hospital, Wenzhou Medical University, Wenzhou, China
9 Shanghai Changzheng Hospital, Shanghai, China.
10 Beijing Friendship hospital, Capital Medical University, Beijing, China


†A list of the members of the Virtual Tumor Project (VTP) consortium is provided in the Acknowledgement.
*These authors contributed equally
# Correspondence should be addressed to: 
Shancheng Ren: renshancheng@gmail.com; Fei Liu: liufei_2359@163.com.

Lead Contact:
Fei Liu, MD, PhD,
Email address: liufei_2359@163.com


 
Abstract
While comprehensive genomic profiling has revolutionized cancer care by enabling genotype-directed therapies, the universal implementation of this paradigm is severely constrained by the invasiveness, high cost and frequent tissue scarcity associated with standard biopsy procedures. Here, we present ARGUS, a pan-cancer deep learning framework trained on longitudinal electronic health records (EHRs) from a multi-center cohort of 80,720 patients with 846,752 follow-up visits across 16 major cancer types. By integrating time-series laboratory values and vital signs, ARGUS infers a broad molecular spectrum, achieving a mean AUROC of 0.843 (0.718–0.951) across over 40 actionable driver genes and 85.4% accuracy for multi-omics signatures including TMB，MSI and PD-L1. Beyond prediction, ARGUS functions as a dynamic "virtual assay" for therapeutic stratification. In the context of targeted therapies, the model successfully stratified progression-free survival outcomes across diverse cancer types, recapitulating clinical trial-grade efficacy differences with hazard ratios (HR) ranging from 2.5 to 4.8 (P < 0.01). Furthermore, in a large pan-cancer cohort treated with immune checkpoint inhibitors, the model successfully stratified patients into distinct prognostic tiers, revealing that predicted responders achieved a twofold survival advantage over the negative group (HR = 2.13, P < 0.01). Mechanistically, we show that these predictions are driven by distinct physiological footprints, demonstrating that specific genomic drivers induce recognizable systemic perturbations across key biological axes, including immunity, metabolism, and hemostasis. This study demonstrates that routine EHR data can be transformed into a scalable, non-invasive precision oncology tool to guide therapeutic decision-making.

 
Introduction
Precision oncology has fundamentally transformed cancer management by shifting the therapeutic paradigm from histology-based empiricism to genotype-directed stratification1-3. The identification of actionable genomic alterations—such as EGFR mutations in lung cancer and BRAF variants in melanoma—has enabled the deployment of targeted therapies that significantly extend patient survival4-6. Currently, tissue-based next-generation sequencing serves as the gold standard for molecular profiling. However, the universal implementation of this "genotype-first" approach faces substantial real-world barriers: tissue biopsies are invasive, costly, and often unfeasible in some patients due to insufficient tumor quantity or poor performance status7. Furthermore, a single tissue biopsy represents only a static spatial snapshot, failing to capture the temporal evolution of tumor biology or the dynamic emergence of resistance mechanisms8-10 While liquid biopsy offers a minimally invasive alternative, its sensitivity remains variable in early-stage or low-shedding tumors, and high costs restrict its frequency in routine monitoring11-13. Consequently, there exists an urgent, unmet need for scalable, cost-effective, and non-invasive strategies to infer tumor molecular status and guide therapeutic decision-making.
Parallel to advances in genomics, the digitization of healthcare has generated vast repositories of longitudinal electronic health records (EHRs), providing a high-dimensional phenotypic view of patient physiology14-16. Artificial intelligence (AI), particularly deep learning, has demonstrated remarkable success in extracting diagnostic signals from medical imaging (radiology and pathology)17-20. However, these image-based modalities often require specialized acquisition and expensive infrastructure. In contrast, routine laboratory tests and vital signs are ubiquitous, standardized, and longitudinally collected throughout the patient journey21-24. Recent studies have begun to explore the utility of EHR data for predicting cancer diagnosis or prognosis25-27. Yet, most existing approaches rely on cross-sectional data snapshots or limited variable sets, overlooking the rich temporal dynamics inherent in serial physiological measurements. More critically, the potential of utilizing these macroscopic physiological data to infer microscopic genomic alterations—effectively creating a "digital molecular proxy"—remains largely unexplored.
Biologically, cancer is not merely a local proliferation of malignant cells but a systemic disease that actively remodels host homeostasis28. Oncogenic driver events orchestrate profound systemic perturbations: for instance, KRAS mutations can trigger systemic inflammation via cytokine secretion29-31, while TP53 alterations often induce metabolic reprogramming that manifests in serum biochemical profiles32-34. These "physiological footprints" are continuously recorded in routine blood tests, creating a latent, high-dimensional mirror of the tumor genome21. We hypothesize that by harnessing the temporal resolution of longitudinal clinical data, deep learning models can decode these subtle, non-linear systemic signals to infer the underlying genomic landscape35. Such an approach would not only democratize access to molecular profiling but also provide a holistic measure of "tumor-host status" that could improve the prediction of therapeutic responses to targeted agents and immunotherapies.
Here, we present a pan-cancer AI framework developed within the large multi-center study, leveraging a massive real-world population of 80,720 patients across 16 major cancer types. We introduce ARGUS (AI-based Routine Genomic Understanding System), a deep learning architecture that integrates static demographic features with longitudinal time-series clinical data to non-invasively infer tumor genomic alterations. Unlike previous organ-specific models, ARGUS uncovers a unified "systemic physiological topology" of cancer genomes, identifying high-fidelity associations between specific driver mutations and systemic phenotypes—a concept we define as "Somatic Physiological Penetrance." We demonstrate that ARGUS not only accurately predicts key actionable alterations and immunotherapy biomarkers but also effectively stratifies overall survival outcomes for patients receiving targeted therapies and immune checkpoint inhibitors. By bridging the gap between macroscopic physiology and microscopic genomics, this study establishes a foundation for next-generation, tissue-agnostic precision oncology.

Results
Construction framework of a large-scale pan-cancer for non-invasive genomic inference
To evaluate the feasibility of inferring tumor genomic alterations from routine physiological data, we curated a large-scale, multi-center cohort comprising 80,720 patients (846,752 follow-up visits) with histologically confirmed malignancies. The study design implemented a rigorous data partitioning strategy to ensure the robustness and generalizability of the model. As illustrated in Figure 1A, the total population was stratified into a development cohort (n = 56,504) for model training and hyperparameter optimization, and an independent test cohort (n = 24,216) strictly reserved for performance evaluation. The demographic and clinical characteristics of the study population are summarized in Supplementary Table 1. 
To capture the systemic physiological perturbations induced by tumor genomic alterations, we developed ARGUS, a deep learning architecture designed to process high-dimensional longitudinal clinical data (Figure 1B, detailed in methods). The model input integrates static demographic information with time-series EHR data, including hematology, biochemistry, vital signs, medication history, etc. A detailed inventory of the over 180 clinical variables included in the analysis is provided in Supplementary Table 2. The ARGUS architecture employs a dual-encoder mechanism, where a Temporal Transformer Encoder utilizes self-attention mechanisms to extract long-range dependencies and dynamic patterns from the longitudinal physiological trajectories, which are then fused with static features to generate a holistic patient representation.
The study cohort encompassed a diverse spectrum of solid tumors, ensuring the pan-cancer applicability of the framework. Figure 1C details the distribution of the 16 major cancer types included in the analysis, with lung cancer, colorectal cancer, and gastric cancer representing the largest subgroups. This broad coverage allows for the investigation of both tissue-specific and tissue-agnostic physiological signatures.
Ground truth labels for model training and evaluation were derived from a comprehensive targeted sequencing panel. As depicted in Figure 1D, this panel covers 520 tumor-associated genes distributed across the human genome. The scope of genomic profiling includes single nucleotide variants, copy number variations, and gene fusions in key driver genes such as TP53, KRAS, and EGFR, as well as complex genomic signatures including tumor mutational burden (TMB) and microsatellite instability (MSI). The complete list of genes and their functional annotations is provided in Supplementary Table 3. To achieve a multi-omics characterization, we further integrated protein expression profiles quantified via immunohistochemistry (IHC). This layer of analysis captured critical therapeutic and prognostic biomarkers, including the immune checkpoint protein PD-L1, receptor tyrosine kinases such as HER2, mismatch repair proteins, and proliferation markers. By mapping these multidimensional genomic data to longitudinal physiological phenotypes, the ARGUS framework establishes a foundation for non-invasive molecular profiling.

High-fidelity inference of actionable genomic alterations and immunotherapeutic biomarkers
To delineate the genomic context for phenotypic inference, we first mapped the broad landscape of somatic alterations across the pan-cancer cohort (Figure 2A). This analysis revealed a highly heterogeneous distribution of mutations, ranging from ubiquitous drivers to rare, tissue-specific events. When applying the ARGUS framework across this entire genomic spectrum, we observed that predictive performance was not uniform; rather, it exhibited intrinsic variability across different tumor lineages and genomic loci. This suggests that the extent to which genomic alterations imprint detectable physiological signals varies depending on the biological context. 
Underpinning our ability to decode these complex signals is the integration of longitudinal temporal dynamics, which provides a tangible advantage over static clinical snapshots. As illustrated in Supplementary Figure 1, sensitivity analyses regarding data density and temporal span confirmed the robustness of this approach. The model’s predictive performance (AUROC and F1-score) exhibited a rapid ascent with the inclusion of the first few clinical visits, significantly outperforming baseline models that relied solely on static admission data (Supplementary Figure 1A). Furthermore, performance remained stable across varying input time windows ranging from 3 months to 5 years, indicating that ARGUS efficiently extracts intrinsic physiological trajectories even from sparse real-world data (Supplementary Figure 1B).
Navigating this performance landscape and prioritizing clinical utility, we strategically curated a subset of over 40 high-value driver genes for detailed evaluation (Figure 2B). These genes were selected based on their established roles as actionable therapeutic targets or critical prognostic indicators in current clinical guidelines. Within this prioritized gene set, ARGUS demonstrated robust discriminative power, achieving a mean AUROC of 0.843 (0.718–0.951). Notably, high predictive fidelity was observed not only for high-frequency drivers but also for actionable alterations with lower prevalence, confirming that ARGUS effectively captures the subtle physiological footprints of these clinically essential genomic events.
While broad predictive capability is promising, the immediate clinical utility of ARGUS hinges on its precision in identifying specific alterations that dictate standard-of-care therapies. We therefore focused our evaluation on high-stakes clinical scenarios where molecular stratification is a prerequisite for treatment prescription. In non-small cell lung cancer (NSCLC), a setting heavily dependent on genotype-directed management, ARGUS achieved exceptional discrimination for EGFR mutations (AUC = 0.929), as well as for ALK and ROS1 fusions (Figure 2C, left). These predictions align closely with the clinical decision points for tyrosine kinase inhibitor (TKI) selection. Similarly, in prostate cancer, the model accurately identified BRCA1/2 alterations (AUC = 0.867) and androgen receptor (AR) status (AUC = 0.919) (Figure 2C, right), demonstrating its potential to non-invasively guide the use of PARP inhibitors and hormonal therapies in advanced disease settings.
Moving beyond single-gene variants, modern precision oncology increasingly relies on complex, pan-cancer genomic signatures to guide immunotherapy. We extended the capability of ARGUS to predict Tumor Mutational Burden (TMB) and Microsatellite Instability (MSI) status, two critical determinants of immune checkpoint inhibitor response. As shown in Figure 2D, the model demonstrated consistent high performance across 16 cancer types, with average AUROCs consistently exceeding 0.85 in tumors with high prevalence of these markers, such as colorectal and gastric cancer. This suggests that the systemic physiological footprint of genomic instability is distinct and detectable, validating the model's potential as a pan-cancer screening tool for immunotherapy eligibility.
Finally, we challenged the framework to bridge the gap between genomics and proteomics by inferring PD-L1 expression status, the primary protein-level biomarker for immunotherapy. Figure 2E presents the confusion matrix for PD-L1 prediction, categorized into three clinically actionable levels (Negative, Positive, High-positive). The model exhibited high concordance with ground truth immunohistochemistry (IHC) labels, achieving an overall accuracy of 85.4%. Critically, from a clinical safety perspective, the rate of "major clinical discrepancies" (specifically, misclassifying a High-positive patient as Negative or vice versa) was negligible. This establishes ARGUS not merely as a genomic predictor, but as a versatile multi-omics inference tool capable of capturing functional protein-level alterations from routine clinical data.

Interpretable AI reveals distinct clinical-genomic phenotypes
Having demonstrated the predictive accuracy of ARGUS, we next sought to deconvolute the underlying decision-making logic and identify the specific physiological signatures driving these predictions. To this end, we extracted high-dimensional latent representations (embeddings) from the model’s bottleneck layer for all patients. Unsupervised manifold learning using Uniform Manifold Approximation and Projection (UMAP) revealed that patients spontaneously organized into 30 distinct phenotypic clusters (Figure 3A). This clustering occurred independently of cancer type labels, suggesting that the model captures intrinsic physiological states shared across different malignancies. To decode the biological meaning of these latent clusters, we mapped the original clinical features back onto the cluster identities (Supplementary Figure 2). This analysis unveiled unique "clinical fingerprints" for each group. For instance, certain clusters were defined by a hyper-inflammatory state (elevated neutrophils and CRP), while others were characterized by metabolic dysregulation (abnormal LDH and albumin levels) or specific tumor marker profiles. This confirms that the model’s internal representations are not abstract mathematical constructs but reflect coherent, biologically interpretable physiological syndromes.
We then correlated these phenotypic clusters with genomic ground truth labels to construct a clinical-genomic enrichment map (Figure 3B). This analysis revealed that genomic alterations do not distribute randomly across the patient population but are preferentially enriched within specific physiological phenotypes. For instance, mutations in the MAPK signaling pathway, including KRAS and BRAF, were disproportionately concentrated in clusters defined by systemic inflammation markers. In contrast, TP53 alterations showed a distinct affinity for clusters exhibiting high metabolic burden and tissue turnover signals (e.g., elevated LDH). Furthermore, lineage-specific drivers such as AR in prostate cancer and EGFR in lung cancer mapped to unique clusters characterized by specific tumor marker profiles and demographic features. These distinct enrichment patterns demonstrate that ARGUS has autonomously learned to associate specific molecular events with their corresponding macroscopic physiological sequelae, without any prior biological knowledge programming.
To further granularize these insights, we performed a deep-dive analysis into lung, breast, and colorectal cancers, visualizing the top 10 most predictive clinical features (ranked by SHAP values) for six clinically paramount driver genes using radar charts (Figure 3C–E). This visualization unveiled gene-specific phenotypic fingerprints within the same histological context. For instance, in lung cancer (Figure 3C), the model utilized divergent feature sets to identify distinct drivers: predictions of EGFR mutations relied heavily on specific tumor markers and demographic features, whereas KRAS mutations were dominated by systemic inflammatory indicators. Similar intra-tumor heterogeneity was observed in breast (Figure 3D) and colorectal cancers (Figure 3E), where distinct radar morphologies—such as the unique signatures of BRCA-mutant or MSI-H tumors—confirmed that ARGUS captures specific, high-dimensional clinical-genomic interactions unique to each driver event, rather than relying on generic cancer signals.
Finally, we utilized SHAP analysis to quantify the precise contribution of individual clinical variables to specific genomic predictions (Figure 3F–I). In cervical cancer, tumor markers such as SCC and CA125 were top predictors for PIK3CA status (Figure 3F), while in liver cancer, markers of hepatic injury and inflammation (IL-6, LDH) drove the prediction of TERT promoter mutations (Figure 3G). Consistent with our cluster analysis, systemic inflammatory markers (LDH, IL-6, CRP) were the dominant predictors for BRAF mutations in melanoma (Figure 3H). Intriguingly, in glioblastoma (GBM), the model identified a specific signature involving age and coagulation markers (Fibrinogen) as predictive of IDH1 mutations (Figure 3I), aligning with the distinct clinical presentation of secondary glioblastomas. Collectively, these interpretability analyses demonstrate that ARGUS learns to recognize biologically plausible, gene-specific systemic footprints from routine clinical data.

ARGUS stratifies therapeutic response to targeted and immune therapies
To evaluate the clinical translational potential of ARGUS, we assessed its capacity to stratify patient outcomes across the broad landscape of precision oncology. Figure 4A visualizes the complex network connecting diverse histological subtypes to specific therapeutic modalities and their corresponding molecular targets. This Sankey diagram maps the distinct molecular dependencies of different cancers, illustrating how ARGUS integrates multi-dimensional inputs to align specific tumor types with their most relevant targeted or immunotherapeutic interventions.
We first addressed the challenge of predicting response to immune checkpoint inhibitors (ICIs) in a pan-cancer cohort. By leveraging the model’s inferred probabilities for key immunogenic determinants (TMB, MSI and PD-L1), we stratified patients into three distinct prognostic tiers: a "Low-Response" group (ARGUS –), a "Standard-Response" group (ARGUS +), and a "High-Response" group (ARGUS ++). As shown in Figure 4B, this stratification revealed a remarkable stepwise survival gradient. The ARGUS (–) group, predicted to lack immunogenic features, exhibited a poor prognosis with a median Overall Survival (OS) of only 8.2 months. In contrast, the ARGUS (+) group achieved a significantly extended median OS of 15.6 months, corresponding to a Hazard Ratio (HR) of 2.13 (95% CI: 1.87–2.43) compared to the low-response group. Most notably, the ARGUS (++) group demonstrated a "super-responder" phenotype with a median OS reaching 23.2 months, representing a further significant survival advantage over the standard responders (HR = 1.66 [1.54–1.79] vs. ARGUS +). This robust, dose-dependent separation (P < 0.001) confirms that ARGUS successfully synthesizes physiological signals into a continuous predictive score that correlates linearly with the magnitude of real-world survival benefit.
We then validated the model's ability to guide targeted therapies in specific high-stakes clinical scenarios, verifying its predictive accuracy across distinct mechanisms of action (Figure 4C). In classic oncogene-addicted settings, ARGUS achieved exceptional stratification. Notably, in NSCLC (EGFR) and melanoma (BRAF), the model identified responders with dramatic precision, yielding HR of 4.8 (95% CI: 3.84–5.94) and 4.2 (3.27–5.32), respectively. This profound predictive capacity was further exemplified in thyroid cancer, where ARGUS successfully pinpointed super-responders to the selective RET inhibitor Selpercatinib, achieving a striking HR of 4.5 (2.48–8.10). The model’s robustness extended across diverse therapeutic mechanisms beyond standard kinase mutations. In renal cell carcinoma, ARGUS effectively stratified outcomes for anti-angiogenic therapy (Sunitinib) with an HR of 3.5 (2.77–4.48). Similarly, it demonstrated strong discriminative power in scenarios involving synthetic lethality and protein overexpression, predicting responses to PARP inhibitors in metastatic castration resistant prostate cancer (HR = 2.8) and Trastuzumab in breast cancer (HR = 2.9), as well as Imatinib in GIST (HR = 2.5). Crucially, in metastatic colorectal cancer, the model demonstrated utility in negative selection. By accurately identifying KRAS-mutant patients who confer resistance to anti-EGFR therapy, ARGUS predicted a significantly inferior outcome for the mutant group (HR = 0.30 [0.29–0.41]), highlighting its potential to spare non-responders from ineffective treatment. Collectively, these analyses demonstrate that ARGUS serves as a robust "virtual assay," capable of translating latent physiological signatures into actionable predictions with clinically meaningful effect sizes.

The systemic physiological topology of tumor genomes
The demonstrated capacity of ARGUS to predict therapeutic outcomes across diverse malignancies suggests a fundamental biological premise: that tumor-intrinsic genomic alterations are not spatially confined to the microenvironment but exert a discernible, deterministic influence on systemic host physiology. To systematically decode these organism-wide footprints, we transitioned from predictive modeling to mechanistic discovery, deploying ARGUS to map the global topology of clinical-genomic interactions.
We first visualized the comprehensive landscape of ARGUS-inferred associations between the entire panel of tumor-associated genes and routine clinical phenotypes (Figure 5A). This unsupervised analysis revealed a discernible, non-random architecture: rather than a diffuse or chaotic distribution of signals, the landscape exhibited a sparse and modular topology. Specifically, high-confidence associations (indicated by strong positive or negative SHAP-derived correlations) were concentrated within distinct "functional blocks." For instance, clusters of genes associated with tumor metabolism formed dense correlation modules with biochemical markers, whereas oncogenic signaling drivers tended to align with inflammatory and hematological clusters. This modular organization suggests that somatic mutations may influence host homeostasis through specific physiological axes, rather than causing generalized systemic dysregulation.
Building on this observation, we sought to quantify the extent to which specific genomic events manifest as detectable systemic perturbations—a concept we introduce here as "Somatic Physiological Penetrance." We mapped the predictive fidelity (AUROC) of ARGUS onto the physical coordinates of the human genome to construct a karyotypic atlas of physiological penetrance (Figure 5B). This genomic landscape indicates a hierarchy: while the majority of passenger mutations appeared physiologically "silent" (low penetrance, light colors), a select group of core driver genes—including TP53 (chr17), KRAS (chr12), EGFR (chr7), and PIK3CA (chr3)—emerged as high-penetrance hubs (deep red). These loci exhibit the strongest systemic footprints, implying that their functional disruption is associated with profound cascades of metabolic, inflammatory, and hematological stress. This karyotypic map provides organism-scale evidence that the "visibility" of a tumor genome to physiological profiling likely correlates with the oncogenic centrality of its driver events.
To deconvolute the biological mechanisms underpinning these high-penetrance signals, we performed a granular analysis across three distinct physiological axes: systemic inflammation, hypercoagulability, and metabolic stress (Figure 5C–E). We first examined Systemic Immune-Inflammatory Dysregulation (Figure 5C). The Manhattan plot identified KRAS, BRAF, STK11 and EGFR as the dominant genomic drivers associated with a composite inflammatory index. Zooming in on the KRAS locus, we analyzed the impact of specific variants on a panel of inflammatory markers, including the Systemic Immune-Inflammation Index (SII), NLR, and CRP (detailed in methods). Notably, ARGUS revealed a residue-specific physiological hierarchy: while all KRAS mutations were associated with elevated inflammation compared to wild-type, mutations at the G12 hotspot triggered the most profound inflammatory response, significantly surpassing the G13 and Q61 variants. This suggests that the model captures the functional intensity of specific oncogenic alleles known to drive an immunosuppressive and pro-inflammatory microenvironment.
Extending this granular analysis to other physiological domains, we next investigated hypercoagulability and thrombotic risk (Figure 5D). The Manhattan plot highlighted receptor tyrosine kinases, particularly MET, ALK, EGFR, ROS1, KDM5C and SETD2 as key drivers of hemostatic dysregulation. Deep-dive analysis of the MET gene revealed a striking mechanistic distinction: the Y1003 mutation (Exon 14 skipping)—which impairs receptor degradation leading to constitutive accumulation—elicited a significantly stronger systemic coagulopathic signal than kinase domain mutations (D1228, Y1230). Finally, in the context of Catabolic Stress and Metabolic Reprogramming (Figure 5E), the landscape was dominated by TP53, MYC, PIK3CA, PTEN and AKT1. Structural analysis demonstrated that mutations affecting the DNA-binding domain, particularly the R175 conformational hotspot, imposed a significantly higher metabolic burden than non-hotspot mutations, suggesting that severe structural destabilization manifests as acute systemic catabolism. 
Ultimately, these multi-dimensional insights—spanning from the macroscopic genomic landscape to microscopic residue-level hotspots—converge to reveal a profound "systemic physiological topology" of cancer. Our findings suggest that, at the level of systemic homeostasis, oncogenic drivers may exert a deterministic influence that transcends anatomical boundaries, manifesting as convergent physiological signatures across diverse tumor types. By decoding this "genotype-driven" systemic syndrome, ARGUS provides a compelling real-world evidence base for tissue-agnostic precision oncology, supporting the biological rationale for next-generation basket trials guided by systemic physiological biomarkers.

Discussion
Our study fundamentally reframes the conceptual understanding of tumor biology by demonstrating that somatic genomic alterations exert a deterministic, detectable influence on systemic host physiology. While traditional oncology views cancer primarily as a local pathology driven by microscopic genetic errors36,37, our findings suggest that these "local" events project a macroscopic "shadow" across the body’s homeostatic systems. This data-driven paradigm resonates with recent computational milestones21,27,38, which validated the utility of machine learning in quantifying penetrance for germline variants. Uniquely extending this principle to the dynamic landscape of acquired disease, we introduce the concept of "somatic physiological penetrance." We reveal that the visibility of a tumor genome to non-invasive profiling is not random but hierarchically organized: core oncogenic drivers such as TP53, KRAS, and EGFR disrupt systemic metabolism, immunity, and coagulation with high penetrance, whereas passenger mutations remain physiologically silent. This "genotype-phenotype mapping" at the organismal scale challenges the conventional dissociation between tumor genomics and systemic medicine, proposing instead that routine electronic health records contain a latent, high-dimensional mirror of the tumor genome that can be decoded by longitudinal deep learning.
From a translational perspective, ARGUS represents a paradigm shift towards a cost-effective, scalable "virtual assay" for precision oncology. The current clinical standard—tissue-based next-generation sequencing—is often limited by tissue availability, turnaround time, and cost39,40. Our results demonstrate that ARGUS can effectively bridge this gap, particularly in high-stakes decision-making. By accurately stratifying therapeutic outcomes for diverse modalities—ranging from targeted therapies in EGFR-altered lung cancer to immunotherapy in pan-cancer cohorts—the model offers a crucial decision-support tool for identifying "super-responders" or screening out non-beneficiaries before invasive procedures are performed. Crucially, the model’s ability to predict overall survival in immunotherapy settings suggests it captures a holistic "immune-host fitness" that genomic tests alone may miss, potentially serving as a superior composite biomarker for complex therapeutic regimens.
The high predictive fidelity of ARGUS raises a fundamental mechanistic question: how do macroscopic routine clinical variables encode microscopic genomic events? Mechanistically, ARGUS's predictive power stems from decoding the longitudinal dynamics of physiological markers rather than static abnormalities. Our interpretability analysis reveals that the model prioritizes the magnitude and velocity of change—a rapidly escalating trajectory often carries more signal than a stable baseline. This methodological principle aligns with our recent work35 and other time-series literature in computational medicine, which demonstrated that similar Transformer architectures could accurately model complex biological dynamics22,23,38,41-43. Crucially, these studies consistently suggest that AI derives predictive power primarily from capturing temporal variations and rates of change, rather than relying solely on static absolute values. Together, these findings confirm that the temporal dimension of EHRs encodes a high-fidelity representation of the host's biological state—whether developmental aging or tumor genomic status—unlocking insights inaccessible to cross-sectional analyses.
Beyond prediction, our study provides unique mechanistic insights into the biological heterogeneity of cancer. A key distinction of our framework is its residue-level resolution: ARGUS did not merely associate genes with outcomes but discriminated the functional intensity of specific mutational hotspots. The observation that TP53 R175 conformational mutations trigger higher metabolic burden than non-hotspot variants, or that MET exon 14 skipping induces a stronger coagulopathic state than kinase domain mutations, validates the biological plausibility of the AI’s learning process. Furthermore, the discovery that physiological signatures (e.g., KRAS-driven inflammation) are conserved across different organs supports the biological rationale for tissue-agnostic "basket trials." It implies that patients sharing the same genomic driver often share the same systemic physiological vulnerabilities, regardless of tumor origin, advocating for a taxonomy of cancer based on molecular-physiological profiles rather than anatomical location alone.
Several limitations of our study merit consideration. First, although we utilized a large-scale multi-center cohort, the study design is retrospective. While we mimicked real-world heterogeneity, prospective validation in a pragmatic clinical trial is essential to confirm the model's utility in guiding actual patient care. Second, while ARGUS infers genomic status from physiological phenotypes, it does not replace tissue biopsy for definitive diagnosis; rather, it serves as a powerful pre-screening or enrichment tool. Third, our mechanistic interpretations are based on data-driven associations; experimental validation in wet-lab models is required to fully elucidate the causal signaling pathways bridging these genomic events to systemic blood markers. Fourth, the current study population is predominantly of East Asian ancestry. Given the well-documented inter-ethnic heterogeneity in cancer genomic landscapes—such as the significantly higher prevalence of EGFR mutations in Asian versus Western lung cancer populations—the generalizability of ARGUS to other ancestral groups remains to be verified. Finally, despite the inclusion of diverse cancer types, the representation of rare tumors remains limited. Future efforts should focus on expanding the framework to cover the full spectrum of oncological and ancestral diversity via federated learning across global health systems.

Conclusion
In conclusion, this study validates the feasibility of using deep learning to infer complex tumor genomic landscapes directly from longitudinal routine clinical data. By capturing the specific systemic signals associated with oncogenic mutations, ARGUS accurately predicts actionable alterations and multi-omics biomarkers with high fidelity. Crucially, the framework functions as a robust "virtual assay," successfully stratifying survival outcomes across diverse cancer types and therapeutic modalities, ranging from standard targeted therapies to immune checkpoint inhibitors. This scalable, non-invasive approach effectively bridges the gap between genomic profiling and clinical accessibility, transforming everyday clinical data into a powerful tool for guiding precision oncology decision-making in real-world settings.

Methods
Study population and data source
This study was designed as a large-scale, multi-center, retrospective cohort study to develop and validate ARGUS (AI-based Routine Genomic Understanding System), a deep learning framework for non-invasive pan-cancer genomic profiling. The overarching goal was to create a unified computational model capable of inferring complex genomic alterations, proteomic biomarkers, and therapeutic responses solely from longitudinal routine physiological data across a broad spectrum of solid malignancies. The study workflow encompassed four primary stages: (1) aggregation and harmonization of large-scale, longitudinal, multi-modal data from a diverse consortium of tertiary medical centers; (2) development of the ARGUS framework, featuring a dual-encoder architecture for static and temporal data integration; (3) rigorous evaluation of the model’s predictive fidelity for genomic and proteomic targets on a strictly held-out independent test set; and (4) demonstration of clinical utility through the stratification of therapeutic outcomes in real-world survival analyses. The study was conducted in accordance with the Declaration of Helsinki, and the reporting of our model follows the TRIPOD (Transparent Reporting of a multivariable prediction model for Individual Prognosis Or Diagnosis) guidelines.
To establish a sufficiently large and heterogeneous dataset, we created the cohort by aggregating data from a multi-center consortium. The data repository was derived from six major tertiary hospitals across China, providing a deep representation of real-world clinical practice. Participating centers included the Cancer Hospital, Chinese Academy of Medical Sciences; The First Affiliated Hospital of Chongqing Medical University; Shanghai Jiao Tong University School of Medicine Renji Hospital; Sun Yat-sen University Cancer Center; Zhongnan Hospital of Wuhan University; and Shanghai Changzheng Hospital. The data collection period covered a span of 24 years, from Jan 2000 to Dec 2024, ensuring the capture of long-term longitudinal trajectories.
Inclusion criteria were designed to capture a representative pan-cancer population requiring molecular profiling. Adult patients (≥18 years) were eligible if they had: (1) a histologically confirmed diagnosis of one of the 16 major solid tumor types (e.g., lung, colorectal, gastric, breast, and liver cancer); (2) availability of a valid clinical-grade targeted next-generation sequencing (NGS) report from tumor tissue samples to serve as ground truth labels; and (3) availability of at least one valid clinical encounter with routine laboratory tests and vital signs recorded within the predefined observation window prior to genomic testing. We applied strict exclusion criteria to ensure data quality: patients with hematologic malignancies (leukemia, lymphoma) were excluded to focus on solid tumor physiology; patients with significant data missingness or technical artifacts in electronic health records were removed; and duplicate records were consolidated. The final study population comprised 80,720 individuals, with a cumulative total of 846,752 longitudinal clinical visits. Detailed demographic and clinical characteristics of the study population are provided in supplementary table 1.
To ensure a rigorous and unbiased evaluation of ARGUS's generalizability, the total study population was partitioned into distinct Development and Independent Test cohorts prior to any model training. We employed a stratified splitting strategy designed to mimic real-world distributional shifts. Specifically, 56,504 patients (70% of the population) were allocated to the Development Cohort for model training, validation, and hyperparameter optimization. The remaining 24,216 patients (30%) were allocated to the Independent Test Cohort. Crucially, as detailed in supplementary table 1, this partitioning preserved the inherent heterogeneity of the multi-center data, resulting in distinct distributions of cancer subtypes and demographic features between the two cohorts. This design ensures that the validation process represents a true "out-of-distribution" test, assessing the model's ability to generalize to new patient populations with varying disease prevalences, rather than merely testing on a random subset of identical data. All records from a single individual were strictly maintained within the same dataset to prevent data leakage.
The study protocol was approved by the Institutional Review Board (IRB) of the participating hospitals. Given the retrospective nature of the study and the use of de-identified data, the requirement for informed consent was waived. All data processing and analysis procedures complied with the Health Insurance Portability and Accountability Act (HIPAA) and the Declaration of Helsinki. The study protocol was registered at ClinicalTrials.gov under the identifiers NCT06791473.

Processing of longitudinal clinical data
We extracted a comprehensive set of longitudinal clinical variables from the raw EHR database to construct the input feature space for ARGUS. The feature set encompassed over 180 distinct variables (Supplementary Table 2), categorized into: (1) Laboratory Tests: including hematology (e.g., complete blood count), biochemistry (e.g., electrolytes, liver/renal function, LDH, albumin), coagulation profiles, and tumor markers (e.g., CEA, AFP); (2) Vital Signs: time-series records of heart rate, blood pressure, body temperature, and respiratory rate; and (3) Demographic and Static Clinical Features: age, sex, and primary cancer diagnosis. To ensure data consistency across multiple centers, a rigorous harmonization pipeline was implemented. This involved mapping local laboratory codes to standard LOINC codes, unifying measurement units, and removing biologically implausible outliers (defined as values falling outside the 0.1st–99.9th percentile range of the entire population distribution).
A critical challenge in analyzing real-world EHR data is the irregularity of clinical visits. Unlike fixed-interval sampling, patient data is sporadic and sparse. To address this, we defined an observation window of 6 months (180 days) prior to the date of genomic profiling for each patient. All valid clinical encounters within this window were aggregated into a temporal sequence. Instead of treating visits as equidistant steps, we employed a "Time-Aware" embedding strategy. For each clinical event, we calculated the relative time elapsed (in days) from the start of the observation window. This relative time encoding was fed into the Transformer model alongside feature values, allowing ARGUS to learn the temporal dynamics and velocity of physiological changes (e.g., the rate of LDH elevation). Real-world clinical data inevitably contains missing values (e.g., a patient may have a blood count but no coagulation test at a specific visit). To prevent data leakage from artificial imputation (such as mean imputation), we adopted a "Masking Mechanism." Specifically, missing values were represented by a learnable "mask token," instructing the model to ignore these specific entries during the self-attention calculation while preserving the information from observed variables. This approach allows the model to robustly handle sparse data without introducing imputation bias.


Genomic and proteomic ground truth definitions
The genomic "ground truth" labels for model training were derived from a CLIA-certified, comprehensive targeted sequencing panel covering the coding exons and select introns of 520 cancer-related genes (Figure 1D, Supplementary Table 3). This panel was designed to detect a broad spectrum of alterations, including single nucleotide variants (SNVs), small insertions/deletions (Indels), copy number variations (CNVs), and gene rearrangements. To ensure clinical relevance and label purity, we strictly filtered genomic alterations based on established oncological guidelines (AMP/ASCO/CAP). Only variants classified as "Pathogenic" or "Likely Pathogenic"—such as known oncogenic hotspots (e.g., KRAS G12/G13, BRAF V600E) and loss-of-function mutations—were considered positive targets for prediction, while variants classified as "Benign" or "Variants of Uncertain Significance (VUS)" were treated as negative (wild-type).
Complementing the genomic profiling, we defined key biomarkers for immune checkpoint inhibitor response by integrating genomic signatures with proteomic expression. Tumor Mutational Burden (TMB) was calculated as the density of somatic non-synonymous mutations, with TMB-High defined as ≥10 mutations/Mb in alignment with FDA-approved indications. Microsatellite Instability (MSI) status was determined via an NGS-based algorithm, binary classifying tumors as MSI-High or Microsatellite Stable (MSS). Furthermore, PD-L1 protein expression was quantified using immunohistochemistry (IHC) on formalin-fixed paraffin-embedded tissues. To support granular clinical decision-making, PD-L1 status was categorized into three classes—Negative, Positive (Low), and High-Positive—based on tumor-specific guidelines using Tumor Proportion Score (TPS) or Combined Positive Score (CPS), thereby establishing a comprehensive multi-omics ground truth for model training.

Model Architecture and Training
Overview of the Dual-Encoder Framework
The ARGUS framework employs a heterogeneous dual-encoder architecture designed to process multimodal clinical data. Let \mathcal{D}\ =\ \{\left(x_i,\ y_i\right)\}_{i=1}^N represent the dataset of N\ patients, where x_i denotes the input features and y_i\in\{0,1\}^C\ denotes the multi-label ground truth vector for C\ genomic targets. The input space for each patient is decomposed into static features x_{static}\in R^{d_{static}} and longitudinal time-series features x_{temporal}\in R^{L\times d_{temporal}} , where L represents the sequence length and d_{temporal}\ is the number of dynamic variables.

Static Feature Encoding
To capture time-invariant patient characteristics (e.g., demographics, cancer type), we implemented a Static Encoder based on a Multi-Layer Perceptron (MLP). This module transforms the raw static vector into a high-level latent representation h_{static}\in R^{d_{model}}. The transformation is defined as:
h_{static}=\mathrm{ReLU}\left(W_2\left(\mathrm{ReLU}\left(W_1x_{static}+b_1\right)\right)+b_2\right)
where W1, W2 are learnable weight matrices and b1, b2 are bias vectors. Batch normalization and dropout were applied between layers to enhance generalization.

Temporal Transformer Encoding
The core of ARGUS is the Temporal Transformer Encoder, designed to model the complex, non-linear temporal dynamics of physiological parameters. The time-series input X^'\in R^{L\times d_{model}}\ is first projected into a d_{model}-dimensional embedding space. To preserve sequential order information—crucial for capturing disease progression trajectories—we injected sinusoidal Positional Encodings (PE) into the input embeddings X^'\in R^{L\times d_{model}}:
PE_{\left(pos,2i\right)}=\sin{\left(\frac{pos}{{10000}^{2i/d_{model}}}\right)}
PE_{\left(pos,2i+1\right)}=\cos{\left(\frac{pos}{{10000}^{2i/d_{model}}}\right)}
The sequence is then processed by a stack of Nx Transformer blocks. Each block consists of a Multi-Head Self-Attention (MSA) mechanism followed by a position-wise Feed-Forward Network (FFN). The self-attention mechanism computes a weighted sum of values based on the compatibility of query (Q) and key (K) vectors:
\mathrm{Attention}\left(Q,K,V\right)=\mathrm{softmax}\left(\frac{QK^T}{\sqrt{d_k}}\right)V
where Q=X^'W^Q,K=X^'W^K,V=X^'W^V. To extract a fixed-length global temporal representation h_{temporal}, we prepended a learnable classification token ([CLS]) to the input sequence and extracted its final state from the last Transformer layer:
h_{temporal}=\mathrm{TransformerEncoder}\left(X^'\right)_{\left[CLS\right]}

Multimodal Fusion and Prediction
To synthesize information from both static background and dynamic trajectories, we employed a Feature Concatenation Fusion strategy. The static and temporal latent vectors were concatenated to form a holistic patient representation z\in R^{\mathbb{2}d_{model}}:
z=\left[h_{static}\oplus h_{temporal}\right]
This fused vector z is then fed into the Prediction Head, a final MLP that maps the latent features to the probability space of genomic alterations. The predicted probability \widehat{y_j} for the j-th genomic target is computed using the sigmoid activation function: 
\mathrm{logits}=W_oz+b_o, \hat{y}=\sigma\left(\mathrm{logits}\right)=\frac{1}{1+e^{-\mathrm{logits}}}

Loss Function and Optimization
The model was trained in an end-to-end supervised manner to minimize the Binary Cross-Entropy (BCE) loss averaged across all C genomic targets. The objective function \ \mathcal{L}is defined as:
\mathcal{L}_{\mathcal{BCE}}=-\frac{1}{C}\sum_{j=1}^{C}\left[y_j\log{\left(\widehat{y_j}\right)}+\left(1-y_j\right)\log{\left(1-\widehat{y_j}\right)}\right]
Optimization was performed using the AdamW optimizer with a weight decay of 1e−4 to prevent overfitting. We employed a cosine annealing learning rate schedule with warm-up to stabilize convergence. Hyperparameters, including the number of Transformer layers (Nx), attention heads, and embedding dimensions (d_{model}), were optimized via grid search on the development cohort.

Model interpretability and physiological penetrance analysis
SHAP-Based Feature Attribution
To deconvolute the "black box" of the deep learning model and quantify the contribution of individual clinical features to specific genomic predictions, we employed SHapley Additive exPlanations (SHAP), a game-theoretic approach to explain the output of machine learning models. We utilized the DeepExplainer framework to compute SHAP values (\phi_{ij}) for each feature j and each patient i. The global importance of a feature j for predicting a specific gene was calculated as the mean absolute SHAP value across the test cohort: 
I_j=\frac{1}{N}\sum_{i=1}^{N}\left|\phi_{ij}\right|.
For the gene-specific phenotypic fingerprints (radar charts in Figure 3C–E), we aggregated these values to rank and visualize the top-10 most predictive clinical features for each driver gene, normalizing the scores to a [0,1] scale for comparative visualization.

Latent Space Clustering and Phenotype Decoding
To investigate whether patients spontaneously organize into distinct physiological states driven by tumor biology, we extracted the high-dimensional fusion embeddings (z\in R^{\mathbb{2}d_{model}}) from the model's penultimate layer. We applied Uniform Manifold Approximation and Projection (UMAP) for dimensionality reduction, followed by Leiden community detection to identify distinct patient clusters (Figure 3A). To "decode" the biological meaning of these latent clusters (Supplementary Figure 2), we performed a phenome-wide association analysis comparing the distribution of each clinical variable within a cluster against the global population mean (using Cohen's d to quantify effect size). Simultaneously, to link these physiological clusters to genomics (Figure 3B), we calculated the enrichment of specific genomic alterations within each cluster using the hypergeometric test, adjusting for multiple comparisons using the Benjamini-Hochberg (FDR) method.

Definition of Somatic Physiological Penetrance
We introduced the concept of "Somatic Physiological Penetrance" to quantify the extent to which a specific tumor-intrinsic genomic alteration manifests as detectable perturbations in systemic host physiology. Mathematically, for a given genomic alteration g, the physiological penetrance P_{phys}\left(g\right)\ is defined as the discriminative capacity of the ARGUS model to identify g solely from routine clinical data, quantified by the Area Under the Receiver Operating Characteristic curve:
P_{phys}\left(g\right)\equiv AUROC\left(g\right)
A high P_{phys} indicates that the mutation imprints a robust, distinct signal on the systemic proteome/metabolome, whereas a low P_{phys}\ indicates a clinically "silent" or localized alteration.

Genomic Landscape and Manhattan Plot Visualization
To visualize these systemic footprints, we mapped the model-derived metrics onto genomic coordinates:
Karyotypic Atlas: We mapped the P_{phys} (AUROC) values to the physical chromosomal location of each gene. The color intensity in the karyogram represents the magnitude of physiological penetrance, highlighting "hotspot" loci that exert the strongest systemic effects.
Phenotype-Genotype Manhattan Plots: To dissect the specific drivers of physiological dysregulation, we adapted the Manhattan plot format typical of GWAS. Here, the X-axis represents the genomic coordinates of the driver genes. The Y-axis represents the statistical significance of the association between the mutation status of gene g and a Composite Physiological Index S (e.g., Systemic Immune-Inflammation Index, Metabolic Burden Score). The association strength was calculated using the Mann-Whitney U test comparing index scores between wild-type and mutant populations, plotted as -\log_{10}{\left(p-value\right)}. 
To validate the mechanistic basis of the observed genotype-phenotype associations, we performed a granular analysis at the amino acid residue level (Figure 5C–E, right panels). For each high-penetrance driver gene (KRAS, MET, TP53), we constructed a gene-specific Composite Physiological Score to quantify the aggregate impact of mutations on host homeostasis. 
    Immuno-Inflammation Score (for KRAS): Calculated as the average Z-score of seven key inflammatory markers: Systemic Immune-Inflammation Index (SII, calculated as  (Platelet×Neutrophil)/Lymphocyte), Neutrophil-to-Lymphocyte Ratio (NLR), C-Reactive Protein (CRP), Platelet-to-Lymphocyte Ratio (PLR), Globulin-to-Albumin Ratio (GAR), White Blood Cell count (WBC), Lymphocyte-to-Monocyte Ratio (LMR, inverted), and Albumin (inverted). This score reflects the intensity of the systemic inflammatory response. 
    Hypercoagulability Score (for MET): A composite index derived from the Z-scores of D-Dimer, Fibrinogen, Platelet count (PLT), Red Cell Distribution Width (RDW), Mean Platelet Volume (MPV), Activated Partial Thromboplastin Time (APTT, inverted), Prothrombin Time (PT, inverted), and Albumin (inverted). This score quantifies the risk of cancer-associated thrombosis. 
    Tumor Metabolic Burden Score (for TP53): An aggregate measure of metabolic stress calculated from the Z-scores of Lactate Dehydrogenase (LDH), Uric Acid (UA), Alkaline Phosphatase (ALP), Gamma-Glutamyl Transferase (GGT), Albumin (inverted), Hemoglobin (inverted), Total Cholesterol (inverted), and Total Protein (inverted).
In the forest plots (Figure 5C–E, bottom left insets), the magnitude of the physiological perturbation induced by gene mutations was quantified using the Standardized Mean Difference (SMD, Cohen's d). For each of the individual clinical markers listed above, we calculated the SMD between the mutant and wild-type populations. An SMD > 0 indicates elevated levels in the mutant group, while an SMD < 0 indicates reduced levels. In the boxplots (Figure 5C–E, bottom right insets), we compared the composite physiological scores across distinct mutational subgroups (e.g., Wild-Type vs. Non-Hotspot vs. Hotspot). Statistical significance between subgroups was assessed using the Kruskal-Wallis test followed by Dunn’s post-hoc test with Bonferroni correction for multiple comparisons.

Clinical utility assessment 
To evaluate the translational utility of ARGUS, we conducted a series of retrospective clinical trials within the independent test cohort. We identified specific patient sub-cohorts who had received standard-of-care therapies and utilized ARGUS as a blinded companion diagnostic tool to infer molecular status solely from baseline clinical data recorded prior to treatment initiation. We curated distinct treatment cohorts to represent diverse oncological mechanisms, ranging from kinase inhibitors in NSCLC, melanoma, GIST, and thyroid cancer to synthetic lethality agents in ovarian and prostate cancers. For these targeted therapy cohorts, the primary clinical endpoint was Progression-Free Survival (PFS), defined as the interval from the date of first treatment administration to the first documented radiological or clinical progression or death from any cause. In the specific context of metastatic castration-resistant prostate cancer, we utilized radiographic PFS (rPFS) assessed according to PCWG3 guidelines. Conversely, for the large pan-cancer cohort treated with immune checkpoint inhibitors, the primary endpoint was Overall Survival (OS)—defined as the time from treatment initiation to death from any cause—selected to adequately capture the long-term survival benefits characteristic of immunotherapy response.
To translate the model’s continuous probability scores into actionable clinical decisions, we implemented a rigorous stratification strategy. Optimal cut-off values for binary classification were determined strictly within the Development Cohort using the Youden Index to maximize discrimination, and these fixed thresholds were subsequently applied to the Independent Test Cohort to prevent data leakage. For the pan-cancer immunotherapy analysis, we employed a specific dual-threshold approach to categorize patients into "Low", "Standard", and "High-Positive" prognostic tiers. The upper threshold was set to identify the top-tier patients enriched for hyper-immunogenic features, while the lower threshold identified those with the lowest probability of response, enabling a granular assessment of dose-dependent survival benefits.
Statistical comparisons of survival outcomes between ARGUS-stratified groups were performed using the Kaplan-Meier method, with differences assessed via the two-sided log-rank test. To quantify the magnitude of the clinical benefit, we utilized univariate Cox proportional hazards regression models to calculate the Hazard Ratio (HR) and its corresponding 95% Confidence Interval (CI). The proportional hazards assumption was verified using Schoenfeld residuals. All survival analyses were performed using standard survival analysis libraries in Python, ensuring rigorous statistical validation of the model's predictive power in real-world clinical settings.

Statistical analysis
Data analysis and model evaluation were performed using a rigorous statistical framework. For baseline demographic comparisons, continuous variables were expressed as mean ± standard deviation (SD) and compared using the independent samples t-test, while categorical variables were presented as frequencies and percentages and compared using the Pearson χ2 test or Fisher’s exact test, as appropriate. All statistical tests were two-sided, and a P-value of less than 0.05 was considered statistically significant across all analyses.
To comprehensively assess the predictive performance of ARGUS, we utilized a suite of metrics including Accuracy, Sensitivity (Recall), Specificity, and the F1-score calculated at optimal thresholds. Given the potential class imbalance inherent in genomic data (where specific mutations may be rare), we prioritized the Area Under the Precision-Recall Curve (AUPRC) alongside the standard Area Under the Receiver Operating Characteristic curve (AUROC) to ensure a robust evaluation of the model's discriminative power. To quantify the statistical uncertainty of these performance metrics, we employed a non-parametric bootstrap procedure with 1,000 iterations to generate 95% Confidence Intervals (CIs) for all reported AUROCs and Hazard Ratios.
All data preprocessing, model training, and statistical analyses were conducted using Python (version 3.10) and R statistical software (version 4.4). The deep learning architecture of ARGUS was implemented using the PyTorch framework, while performance metrics and classical statistical tests were computed using the Scikit-learn library and the R stats package. Survival analyses and visualization were performed using the Lifelines and Seaborn/Matplotlib libraries, respectively.

Declaration of interests
The authors declare no competing interests.

Contributors
F.L. and S.R. conceived, designed, and supervised the entire project. F.L. and S.R. were the corresponding authors who provided critical guidance and oversight. L.W. (Liyuan Wu), H.Y., R.C., and S.H. contributed equally to this work. They were responsible for the development of methodology, formal analysis, investigation, data visualization, and writing the original draft. S.C., Z.W., H.W., D.C., W.W., Y.G., X.L., X.W., Y.M., B.H., F.W., L.W. (Lan Wang), D.L., Q.Z., and P.M. contributed to data curation, sample collection, and provision of resources. All authors reviewed, discussed, and approved the final manuscript.


Acknowledgements
This work was supported by grants from the National Natural Science Foundation of China (32100631 and 32470964 to F.L., 8212502 and 82330091 to S.R., 82303655 to H.Y.), National Key Research and Development Program of China (2024ZD0525200 to S.R.), Shanghai Shenkang Hospital Development Center (SHDC12022117 and SHDC2022CRT005 to S.R.), Shanghai Municipal Education Commission (2023ZKZD46 to S.R), China Postdoctoral Science Foundation (2023T160061 to F.L.), Beijing Nova Program (20240484627 to F.L.), Macao Young Scholars Program (AM2023018 to F.L.), Capital Funds for Health Improvement and Research (2024-4-40215 to F.L.). We thank all the participants who generously gave their time to take part in the VTP study. We are incredibly grateful to all the staff at the 10 participating academic and secondary care sites who were dedicated to delivering this study, including the research nurses, clinical trial practitioners, and data managers. 
†VTP Consortium
Institutions: The Virtual Tumor Project (VTP) consortium is a collaborative effort composed of the following 10 institutions: National Cancer Center/National Clinical Research Center for Cancer/Cancer Hospital, Chinese Academy of Medical Sciences and Peking Union Medical College; The First Affiliated Hospital of Chongqing Medical University; Renji Hospital, Shanghai Jiao Tong University School of Medicine; Sun Yat-sen University Cancer Center; Zhongnan Hospital of Wuhan University; The First Affiliated Hospital of Dalian Medical University; Beijing Tsinghua Changgung Hospital; Eye Hospital, Wenzhou Medical University; Shanghai Changzheng Hospital; and Beijing Friendship Hospital, Capital Medical University.
Investigators:
The following investigators participated in the VTP consortium: Liyuan Wu, Hubin Yin, Rui Chen, Sujun Han, Shunan Che, Zixian Wang, Hong Weng, Dong Chen, Wenkuan Wang, Youyan Guan, Xingkai Li, Xuhang Wang, Ying Ma, Baoyi Han, Fangming Wang, Lan Wang, Duocai Li, Qinxin Zhao, Peipei Meng, Shancheng Ren and Fei Liu.

Data and code availability
The large-scale, longitudinal clinical and genomic datasets generated and analyzed during the current study are derived exclusively from the internal electronic health record systems and biobanks of the 10 participating institutions within the Virtual Tumor Project (VTP) consortium. To promote scientific transparency and collaboration, de-identified data may be made available to qualified researchers upon reasonable request to the corresponding authors (F.L. or S.R.). The source code for the ARGUS framework, including the architecture of the dual-encoder model, data preprocessing pipelines, and scripts for model training, validation has been deposited in a GitHub repository. It is publicly available as of the date of publication under an open-source license to facilitate reproducibility. The repository can be accessed at:  https://github.com/AIprojects-felix/ARGUS).
 
Figure Legends
Figure 1 | Development and validation of a large-scale pan-cancer framework for non-invasive genomic inference.
(A) Schematic overview of the study design, illustrating the construction of the multi-center cohort comprising 80,720 patients across 16 major solid tumor types. The population was partitioned into a development cohort (n = 56,504) and a strictly held-out independent test cohort (n = 24,216) to ensure rigorous evaluation. (B) Architecture of the ARGUS deep learning model. The framework employs a dual-encoder mechanism: a static encoder processes demographic data, while a temporal Transformer encoder extracts dynamic patterns from longitudinal time-series electronic health record (EHR) data (e.g., laboratory values, vital signs). These features are fused to generate a holistic patient representation for multi-task prediction. (C) Distribution of patient counts across the 16 included cancer types in the total cohort, highlighting the substantial representation of major malignancies such as lung, colorectal, and gastric cancers. (D) Circos plot depicting the Comprehensive Actionable Oncology Panel used as ground truth. The panel covers over 520 tumor-associated genes across the human genome, including key drivers and complex signatures, serving as the reference standard for model training and validation.

Figure 2 | High-fidelity inference of actionable genomic alterations and immunotherapeutic biomarkers.
(A) Global heatmap visualizing the landscape of somatic genomic alterations across 16 cancer types in the study cohort. Rows represent genes and columns represent tumor types; cell color intensity indicates the Z-score standardized mutation frequency, revealing distinct molecular patterns and tissue-specific mutational burdens. (B) Dot plot summarizing the predictive performance of ARGUS for over 40 clinically prioritized driver genes across different cancer types. Dot size represents the fraction of positive samples, and color indicates the Area Under the Receiver Operating Characteristic curve (AUROC). (C) ROC curves demonstrating the model’s discriminative performance for specific standard-of-care targets in representative high-stakes clinical scenarios: Left, prediction of EGFR mutations, ALK fusions, and ROS1 fusions in non-small cell lung cancer; Right, prediction of BRCA1/2 mutations and AR alterations in prostate cancer. Shaded areas represent 95% confidence intervals. (D) Bar chart showing the model’s performance (AUROC) in predicting complex immunotherapy biomarkers—Tumor Mutational Burden (TMB-High, >10 mut/Mb) and Microsatellite Instability (MSI-H)—across all 16 cancer types. (E) Confusion matrix evaluating the concordance between ARGUS-predicted and pathologist-assessed PD-L1 expression status (Negative, Positive, High-positive). The table below summarizes key performance metrics including Accuracy, F1-score, Precision, and Recall for each class, demonstrating high agreement and minimal major clinical discrepancies.


Figure 3 | Interpretable AI reveals distinct clinical-genomic phenotypes.
(A) UMAP visualization of the latent patient representations (embeddings) learned by ARGUS. Each dot represents a patient, color-coded by the 30 distinct phenotypic clusters identified via unsupervised learning, demonstrating that the model captures intrinsic physiological states beyond tumor type. (B) Clinical-genomic enrichment map linking the 30 phenotypic clusters (y-axis) to specific genomic alterations (x-axis). Color intensity represents the normalized enrichment score, revealing that specific drivers are non-randomly concentrated within distinct physiological clusters. (C–E) Radar charts visualizing the gene-specific phenotypic fingerprints for key drivers in lung (C), breast (D), and colorectal (E) cancers. The axes represent the top 10 most predictive clinical features ranked by SHAP values, illustrating the intra-tumor heterogeneity of physiological signatures. (F–I) SHAP summary plots for individual gene predictions in specific cancer types: (F) Cervical cancer (PIK3CA), (G) Liver cancer (TERT), (H) Melanoma (BRAF), and (I) GBM (IDH1). Each dot represents a patient; color indicates feature value (red=high, blue=low), and x-axis position indicates the impact on model output, confirming biologically plausible feature attributions.

Figure 4 | ARGUS predicts response to targeted and immune therapies.
(A) Sankey diagram illustrating the landscape of precision oncology covered by the study. Flows connect 16 cancer types to two primary therapeutic strategies (Targeted Therapy, Immunotherapy) and subsequently to specific actionable molecular targets, demonstrating the broad clinical applicability of the framework. (B) Kaplan-Meier curves for Overall Survival (OS) in a pan-cancer cohort treated with immune checkpoint inhibitors. Patients were stratified by ARGUS into High-Positive (++), Standard (+), and Low (-) tiers based on predicted immunogenicity. The stepwise separation of curves (HR=2.13 for + vs -; HR=1.66 for ++ vs +) confirms the model’s ability to identify responders. (C) Kaplan-Meier curves for Progression-Free Survival (PFS) or Radiographic PFS (rPFS) in eight high-stakes targeted therapy scenarios. The model successfully stratified responders from non-responders across diverse mechanisms, including kinase inhibitors (e.g., Selpercatinib in thyroid cancer, HR=4.5), synthetic lethality (e.g., Olaparib in ovarian/prostate cancer), and negative selection (e.g., Cetuximab in colorectal cancer). Shaded areas represent 95% confidence intervals.

Figure 5 | The systemic physiological topology of cancer genomes.
(A) Landscape of ARGUS-inferred clinical-genomic associations. The heatmap displays the correlation between genomic alterations (x-axis) and routine clinical features (y-axis), revealing a sparse, modular architecture where high-penetrance drivers affect specific physiological systems. (B) Karyotypic atlas of Somatic Physiological Penetrance. The color intensity on the chromosomes represents the predictive fidelity (AUROC) of ARGUS for each gene, highlighting core drivers (TP53, KRAS, EGFR) as high-penetrance hubs that exert the strongest influence on systemic physiology. (C–E) Multi-scale dissection of genomic drivers across three physiological axes: Systemic Immune-Inflammatory Dysregulation (C), Hypercoagulability (D), and Catabolic Stress (E). Left panels (Manhattan Plots): Visualization of genomic loci associated with composite physiological indices Y-axis: -\log_{10}{\left(p-value\right)}. Prominent peaks identify KRAS, MET, and TP53 as master regulators of inflammation, coagulation, and metabolism, respectively. Right panels (Residue-Level Analysis): Top: Gene structure diagrams highlighting key mutational hotspots. Bottom Left (Forest Plots): Quantification of the effect size of mutations on individual clinical markers (e.g., SII, NLR, CRP for KRAS; D-Dimer, Fibrinogen for MET; LDH, Albumin for TP53). Data are presented as Standardized Mean Difference (SMD) with 95% CIs; SMD > 0 indicates elevation in mutants. Bottom Right (Box Plots): Association between specific mutation types and Composite Physiological Scores. Statistical significance was assessed using the Kruskal-Wallis test (∗∗P<0.01, ∗∗∗P<0.001).

Supplementary Figure 1 | Model performance across different clinical follow-up data.
(A) Line plot illustrating the relationship between model performance (AUROC in red, F1-score in blue) and the number of clinical follow-up visits included in the input sequence. Error bars represent the standard deviation across 5-fold cross-validation. (B) Line plot showing model performance as a function of the input time range (observation window) prior to genomic profiling. 

Supplementary Figure 2 | Heatmap of EHR feature distribution in phenotypic clusters.
This heatmap decodes the biological characteristics of the 30 latent patient clusters identified by ARGUS (corresponding to Figure 3A). Rows: 180+ routine clinical features grouped by physiological category. Columns: The 30 distinct phenotypic clusters (Cluster 0–29). Color Scale: Represents the Standardized Clinical Features Score (Z-score), where Red indicates higher-than-average values and Blue indicates lower-than-average values compared to the global population mean.

 
Supplementary Table 1 | Baseline demographic and clinical characteristics of study population
Variables	Total 
Cohort
(n= 80,720)	Development
Cohort
(n= 56,504)	Independent Test Cohort
(n= 24,216)
age (years, SD)	60.5 ± 13.5	61.2 ± 13.1	58.8 ± 14.2
gender			
male	41,168	29,382	11,786
female	39,552	27,122	12,430
total visits (n)	846,752	638,495	208,257
mean visits (v/n)	10.5	11.3	8.6
solid cancer category (n, %)			
lung cancer	15,943 (19.8%)	11,532 (20.4%)	4,411 (18.2%)
colorectal cancer	10,869 (13.5%)	8,054 (14.3%)	2,815 (11.6%)
gastric cancer	9,317 (11.5%)	6,886 (12.2%)	2,431 (10.0%)
breast cancer	8,154 (10.1%)	4,771 (8.4%)	3,383 (14.0%)
liver cancer	7,963 (9.9%)	5,812 (10.3%)	2,151 (8.9%)
esophageal cancer	6,219 (7.7%)	4,518 (8.0%)	1,701 (7.0%)
thyroid cancer	4,267 (5.3%)	2,067 (3.7%)	2,200 (9.1%)
prostate cancer	2,407 (3.0%)	1,742 (3.1%)	665 (2.7%)
pancreatic cancer	2,331 (2.9%)	1,684 (3.0%)	647 (2.7%)
bladder cancer	2,174 (2.7%)	1,591 (2.8%)	583 (2.4%)
cervical cancer	2,136 (2.6%)	1,383 (2.4%)	753 (3.1%)
ovarian cancer	2,058 (2.5%)	1,495 (2.6%)	563 (2.3%)
renal cancer	1,839 (2.3%)	1,332 (2.4%)	507 (2.1%)
uterine cancer	1,729 (2.1%)	1,246 (2.2%)	483 (2.0%)
brain cancer	1,368 (1.7%)	987 (1.7%)	381 (1.6%)
melanoma	789 (1.0%)	568 (1.0%)	221 (0.9%)
other cancer	1,158 (1.4%)	837 (1.5%)	321 (1.3%)
Data are presented as number (%) for categorical variables and mean ± standard deviation (SD) for continuous variables. Total visits refer to the aggregate number of distinct clinical encounters recorded in the EHR system for each patient during the study period. Mean visits represents the average utilization of healthcare resources per patient, calculated by dividing the Total visits by the sample size (n) of each cohort. Percentages for individual cancer types and stages are calculated relative to the total number of patients in the same cohort. Other cancers include rare solid tumors not categorized into the 16 major types listed above, such as ocular neoplasms, sarcomas, neuroendocrine tumors, head and neck squamous cell carcinomas (excluding esophageal/thyroid), and carcinomas of unknown primary.

